Non-singular orbital elements for special perturbations
in the two-body problem
Giulio Bau,`
1 ‹
Claudio Bombardelli,
2
Jesus Pel ́ aez ́
2
and Enrico Lorenzini
3
(^1) Department of Mathematics, University of Pisa, Largo Pontecorvo 5, I-56127 Pisa, Italy
(^2) Department of Applied Physics, Technical University of Madrid, Plaza Cardenal Cisneros 3, E-28040 Madrid, Spain
(^3) Department of Industrial Engineering, University of Padova, Via Venezia 1, I-35131 Padova, Italy
Accepted 2015 September 8. Received 2015 September 5; in original form 2015 July 29

ABSTRACT
Seven spatial elements and a time element are proposed as the state variables of a new special
perturbation method for the two-body problem. The new elements hold for zero eccentricity
and inclination and for negative values of the total energy. They are developed by combining a
spatial transformation into projective coordinates (as in the Burdet–Ferr ́andiz regularization)
with a time transformation in which the exponent of the orbital radius is equal to one instead
of two (as commonly done in the literature). By following this approach, we discover a new
linearization of the two-body problem, from which the orbital elements can be generated by
the variation of parameters method. The geometrical significance of the spatial quantities is
revealed by a new intermediate frame which differs from a local vertical local horizontal frame
by one rotation in the instantaneous orbital plane. Four elements parametrize the attitude in
space of this frame, which in turn defines the orientation of the orbital plane and fixes the
departure direction for the longitude of the propagated body. The remaining three elements
determine the motion along the radial unit vector and the orbital longitude. The performance
of the method, tested using a series of benchmark orbit propagation scenarios, is extremely
good when compared to several regularized formulations, some of which have been modified
and improved here for the first time.
Key words: methods: numerical – celestial mechanics – minor planets, asteroids: general.
1 INTRODUCTION
With the rapid development of punched-card machines in the late
1930s, computation of orbits of celestial bodies by automatic meth-
ods became a common practice. Paul Herget, the first director of the
Minor Planets Center (MPC), was a pioneer in the use of machine
methods for minor planets ephemeris computation. In 1947, he
started to adopt the special perturbations approach to predict plan-
etary motions (Marsden 1980 ). Due to the limited computational
capacity available at that time, special perturbation schemes based
on the variation of parameters (VOP) became an attractive alterna-
tive to Cowell’s and Encke’s formulations mainly because in many
problems the same accuracy could be achieved with a larger integra-
tion step (Herrick 1948 ). Among the different VOP approaches, the
classical elliptic elements were not well suited to the purpose, since
more simple, symmetrical equations and more uniform operations
were desirable (Musen 1954 ). On the other hand, it was known that
special perturbations of orbital elements based on vectorial inte-
grals of the two-body problem (vectorial elements) enjoy all these
properties.

E-mail:bagiugio@gmail.com

Stromgren’s VOP method (Str ̈ omgren ̈ 1929 ;Musen 1954 )was
the first to be derived by means of vector calculus, and the MPC
implemented it to calculate first-order perturbations of planets
(Marsden 1980 ). However, the breakthrough in the use of vectorial
elements came from Milankovic( ́ 1939 ), who derived the equations
of the eccentricity and angular momentum vectors ( e and h )in
Lagrangian form for general planetary perturbations. Following the
same idea, Herrick ( 1948 , 1953 ) replaced five of the classical elliptic
elements by the vectors e , h × e , and integrated the corresponding
differential equations to determine the special perturbations of the
asteroid Icarus. His formulation was superior to Stromgren’s for ̈
ephemeris computation, because the directions of the major and
minor axes of the osculating ellipse ( a and b ) are obtained in a
much more direct and fast way. Musen ( 1954 ) improved Herrick’s
method by choosing h × e /p(where p is the semilatus rectum) and
h as elements, and the algorithm was extensively applied to the mi-
nor bodies of the Solar system (Herget 1962 ; Marsden 1980 ). The
vectorial method was exploited by Musen ( 1960 ,1961b) to study
also the perturbed motion of an artificial satellite around the Earth.
An exhaustive survey of vectorial orbital elements of the
Milankovi ́c type for both special and general perturbations of the
two-body problem is found in Rosengren & Scheeres ( 2014 ). All
these methods do not present the singularity for zero inclination
©C2015 The Authors
Published by Oxford University Press on behalf of the Royal Astronomical Society
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
New non-singular orbital elements 2891
because the classical Euler angles (, i ,ωfor the longitude of
the node, inclination, argument of pericentre, respectively) are re-
placed by the direction cosines of the perifocal basis{ a , b , k }, with
k = a × b perpendicular to the orbital plane. However, the unit vec-
tors a and b become meaningless when the eccentricity is zero.^1 This
intrinsic singularity produces small divisors in the differential equa-
tions, which bring to a deleterious loss of accuracy in the numerical
integration of near circular motion (Herget 1962 ). The difficulty
can be avoided in the vectorial elements with a simple change of
variables (for example, by employing e and h × e instead of a and
b ), while it is impossible to eliminate from the equation that governs
the angular displacement of the propagated object with respect to
a (Musen 1954 ). Indeed, one way to remove also this singularity is
to reckon the angular position from a departure point (here denoted
by s ) which lies on the orbital plane, is fixed along a Keplerian
motion, and does not depend on the orientation of the apsidal line.
One of the first sets of non-singular elements (i.e. valid for zero
inclination and zero eccentricity) for special perturbations is due to
Pines ( 1961 ). The departure direction is given by the initial position
on the osculating orbit, which, along with the initial velocity, are
the parameters chosen to describe the motion. Pines’ elements are
canonical (Cohen & Hubbard 1962 ) and avoid the additional equa-
tion for the variable related to the angular displacement along the
osculating ellipse.
The concept of a departure point, introduced by Hansen ( 1857 ,
p. 71), suggests that a possible way to obtain non-singular elements
(not necessarily vectorial) is to refer the motion to an intermediate
frame {F; s , t , k }, with the origin F at one focus of the osculating
conic and where t = k × s. In the well-known set of equinoctial
elements investigated by Broucke & Cefola ( 1972 ) and in all its
variations (Hintz 2008 ), the orbital position is recovered from the
departure point by means of the true longitude L =+ f ,where
=+ωand f is the osculating true anomaly. It follows that
the orientation of the equinoctial frame depends only onand
i. The timing along the orbit is controlled by the mean longitude
at the epoch which is free of singularities. The computation of L
requires to solve Kepler’s equation written in terms of the eccentric
longitude, unless this is chosen as the independent variable in place
of the physical time (Fukushima 2008 ). Herrick ( 1953 ) modified
his original method by replacing the mean anomaly with the mean
longitude in the equinoctial frame. The equinoctial true and mean
longitudes have been recently adopted by Rosengren & Scheeres
( 2014 ) in substitution of the time of pericentre passage for deriving
non-singular equations of Milankovi ́c’s vectorial elements, both in
Lagrangian and Gaussian form.
The ideal coordinates were conceived by Hansen ( 1857 , p. 66) to
develop a theory of general perturbations of minor planets (see also
Brown 1896 , chapter X). The reference frame{F; s , t , k },where s
is placed at a departure point, is ideal if the component along k of its
angular velocity is zero (Deprit 1976 ). The condition that s is fixed
in the plane of the orbit reflects on the constraint dσ+cos i d
=0, where the pseudo-elementσis the angle measured positively
eastwards from the ascending node to s.^2 The longitude of the
propagated object is an ideal coordinate and is given byφ=χ+ f ,

(^1) Str ̈omgren’s method and its modified version proposed by Musen (1961a)
to compute higher order effects, employ as vectorial quantities the angular
velocity vector and Gibbs’ vector semitangent of version (Wilson 1901 ,p.

of the perifocal frame, respectively.
(^2) The definition of pseudo-element is given in Brown ( 1896 , p. 74). Note
that the author adopts the opposite convention for the angleσ.
whereχ=ω−σ(Brown 1896 , p. 163). An attractive property of
the ideal frames is that the equation of motion projected along the
axes of s and t (Hansen 1857 , p. 69; Broucke, Lass & Ananda 1971 ,
equation 53) take the same form as in a fixed frame. A separation is
therefore achieved to some extent between the motion in the orbital
plane and the rotation of the ideal frame. Garofalo ( 1960 ) chose as
elements the direction cosines of the ideal axes with respect to fixed
rectangular axes, the angular momentum h , and the projections of
the vector e /palong s and t. The true longitudeφis also included
in this set. A similar, but much less-redundant system of equations
was obtained by Herget (who seems unaware of Garofalo’s work)
by using Rodrigues’ parametrization of a finite rotation (Rodrigues
1840 , p. 400) in the form given by Cayley ( 1843 , i.e. Gibbs’ rotation
vector). Instead ofφ, the author picks as angular variable the sum of
the perturbed portion of the mean anomaly and the pseudo-element
χ(as Stromgren already did; see Musen ̈ 1954 , equation 32).
Cayley’s vector works also when the inclination is zero, but it
fails for half turns. On the other hand, Euler parameters (Whittaker
1917 , p. 8) allow us to remove any singularity with the addition
of just one redundant variable. They were introduced by Broucke
et al. ( 1971 ), Vitins ( 1978 ), Chelnokov ( 1992 ), Sharaf, Awad &
Najmuldeen ( 1992 ), and Pel ́aez, Hedo & de Andres ( ́ 2007 ) in rela-
tion to the local vertical local horizontal frame (hereafter it will be
called orbital frame), and by Musen ( 1964 ), Hestenes ( 1983 ,where
they form a spinor), and Gurfil ( 2005 ) for the perifocal frame. The
non-singular set of elements developed by Cohen & Hubbard ( 1962 )
includes a quaternion that brings information about the angular mo-
mentum and the attitude of an intermediate frame. As concerns
the ideal coordinate system, the Euler parameters are employed by
Musen ( 1958 ) in a special perturbation method based on Hansen’s
theory. Deprit ( 1975 ) suggested their use to improve Herget’s for-
mulation. After explaining the geometrical significance of Hansen’s
ideal frame, the motion in the orbital plane is described by the ideal
mean longitude (denoted by U in Herget 1962 , equation 51), and
three elements almost identical to those presented by Herget and
Garofalo.
So far we have seen that the definition of a suitable intermediate
frame is a powerful tool for generating non-singular elements. A
different approach consists in regularizing the two-body problem
(see for example the introduction in Bau, Bombardelli & Pel` ́aez
2013 ), so that the solution of the transformed linear system can
be written explicitly. The resulting constants of integration are re-
garded as new variables to describe the perturbed motion. Stiefel &
Scheifele ( 1971 , section 19) and Burdet ( 1968 , 1969 ) derived from
the Kustaanheimo–Stiefel (K–S; Kustaanheimo & Stiefel 1965 ;
Stiefel & Scheifele 1971 , chapter 2) and Sperling’s regularizations
(Sperling 1961 ; Burdet 1967 ), respectively, non-singular elements
for vanishing eccentricity, inclination, and orbital radius. Chelnokov
( 1992 ) showed that the K–S variables can be related to a unit quater-
nion. Its components represent a coordinate system which has one
axis oriented along the radial direction i and does not rotate around
i at any time. In the absence of perturbations, the unit quaternion is
the solution of an harmonic oscillator of frequency one half with re-
spect to the true anomaly. Then (Chelnokov 1993 ), two quaternions
are introduced by the VOP method as part of a set of non-singular
elements.
In Burdet’s focal method (Burdet 1969 ) the position vector is
decomposed into the product of the orbital radius ( r )andthera-
dial unit vector, which after Ferrandiz ( ́ 1988 ) are called projective
coordinates. The reciprocal radiusρand the vector i satisfy linear
differential equations in the pure two-body motion if the transfor-
mation d t = r^2 d s , from the time t to the independent variable s ,
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
2892 G. Bauetal.`
is applied. The constants that were attached toρ, i ,and t , along
with the semilatus rectum, are topologically regular elements, but
are not defined at collision (Stiefel & Scheifele 1971 ,p.78).Aswe
learnfromFlury&Janin( 1975 ), Burdet derived an analogous set
of focal elements by taking as independent variable the true longi-
tudeφinstead of s. With this choice, the oscillation frequency of
the variablesρ, i is equal to one for Keplerian motions and so their
evolution become Lyapunov stable (Vitins 1978 ; Fukushima2007a,
appendix C2). Moreover, Vitins ( 1978 ), first noted that the normal
form of the differential equation for the radial unit vector naturally
leads to introduce the orbital frame. Then, he suggested to use Euler
parameters to represent this frame, thus eliminating two redundant
variables from Burdet’s original formulation, and still preserving
the stability of the corresponding system.
The VOP scheme of Pelaez et al. ( ́ 2007 ), referred to as Dromo,
was derived from the same equations of the improved Burdet’s
method reported in Vitins ( 1978 ). In Dromo, the variables of inte-
gration are: the physical time, four Euler parameters associated with
an ideal frame named departure frame,^3 the inverse angular momen-
tum ( q 3 ), and the projections of the vectorq 3 e on two orthogonal
axes of a second ideal frame which, in general, does not coincide
with the departure frame.^4 Even if Dromo and Deprit’s formulations
implement almost the same spatial elements, the former is more ad-
vantageous for numerical integration. In fact, the analytic step-size
control (Stiefel & Scheifele 1971 , p. 77) induced by the fictitious
timeφgreatly improves the performance achievable with a fixed
step-size integrator. Besides, the time element included by Deprit
in order to recoverφworks only for elliptic motion. On the other
hand, in Dromo such angle is directly provided by the independent
variable itself, which is well defined for any non-degenerate conic.
A consequent benefit is that Kepler’s equation does not need to be
solved.
The independent variableφof Dromo is related to the time t by
d t = r^2 q 3 dφ.InBau et al. (2013 ), a modified form of this time transformation, borrowed from Sharaf et al. ( 1992 ), was adopted to derive generalized Dromo elements which are more advantageous for conservative forces. The key step is to define a generalized angular momentum by including the disturbing potential in the contribution of the kinetic energy due to the transverse component of the velocity. Time elements for the generalized counterparts of Dromo elements were developed in Bau & Bombardelli ( 2014 )to
reduce the integration error in the physical time. We have recently
discovered that a similar set of elements as in Bau et al. (2013 ) with one of the time elements in Bau & Bombardelli ( 2014 )wasderived
by Vitins ( 1978 ).
Numerical tests to evaluate the performance of non-singular el-
ements for orbit computation appeared in the early 1970s. While
Stiefel & Scheifele ( 1971 , section 23) and Bond ( 1974 ) report the
results of their own elements only, Burdet ( 1968 ) includes Encke’s
method and a set of K–S elements taken from Stiefel et al. ( 1967 ),
in addition to his natural elements. Comparisons with Cowell’s
method were undertaken by Dallas & Rinderle ( 1974 ), Velez et al.
( 1974 ),Flury&Janin( 1975 ), and revealed that VOP methods are

(^3) If at the initial epoch the departure point of the ideal coordinate system
introduced by Deprit ( 1975 ) is located by the position vector, then at any
epoch the departure frame coincides with Deprit’s ideal frame up to a rotation
of 90◦around the radial direction. This discrepancy is due to the definition
of the orbital frame given in Pelaez et al. ( ́ 2007 , equation 2).
(^4) The two frames differ by a rotation around the common axis normal to the
orbital plane equal to the initial value of the independent variable.
increasingly more accurate for the same computational cost as the
perturbations become weaker and more complicated to calculate.
In later years, the use of VOP schemes for special perturbations fell
into oblivion, out of which it was recalled by Ferrandiz, Sansaturio ́
&Vigo( 1991 ), Palacios & Calvo ( 1996 ), Arakida & Fukushima
( 2001 ), and Barrio & Serrano ( 2008 ). More recently, Bauetal. ( 2013 )andBau & Bombardelli ( 2014 ) investigated the behaviour
of the generalized Dromo elements with and without a time ele-
ment for perturbed motion around the Earth. It turns out that these
formulations substantially improve the original method of Pel ́aez
et al. ( 2007 ), and show an excellent performance when propagating
circular to moderately eccentric perturbed orbits. However, at high
eccentricities the benefit of the spatial elements is partly obscured
by the lower performance of the time (or time element) integra-
tion compared to methods constructed on a time transformation of
the Sundman type (i.e. linear in the orbital radius). This is espe-
cially true with third-body perturbations and when employing fixed
step-size integrators.
These facts motivate the effort to develop in the framework of
the projective decomposition a new set of elements starting from a
classical Sundman transformation of the physical time. Such task is
the focus of the paper. Since the method is proposed as a companion
procedure to be used when the enhanced versions of Dromo become
less efficient, our test campaigns deal with perturbed orbits of high
eccentricity. More specifically, we consider two examples represen-
tative of weak and moderate perturbations, and a third case with a
more realistic propagation around the Earth. The performance of
the new non-singular elements is assessed with respect to several
other sets of regular elements, regularizations, and a stabilized form
of Cowell’s method.
The paper is organized as follows. Section 2 gives a brief descrip-
tion of the new method. In Section 3, we address the radial motion
and introduce the first three elements. Section 4 is devoted to the
time element. In Section 5, we define the intermediate frame and
the related Euler parameters, first in a geometrical way, and then by
following a VOP approach. Section 6 collects the differential equa-
tions of the elements and illustrates the implementation for carrying
out a numerical integration with our method. Section 7 contains the
results on the performance, and Section 8 reports the conclusions.
Finally, in the appendices we derive non-obvious relations given in
the theory and we describe the modifications that we have applied
to improve some formulations selected for the numerical tests.

2 OVERVIEW OF THE NEW FORMULATION
In the same way as in Stiefel & Scheifele ( 1971 , p. 87) we change
the independent variable through a Sundman transformation of the
physical time into the angleφ. In the case of unperturbed motion,
the quantityφcoincides, up to an additive constant, to the eccentric
anomaly. Complying with the approach of the projective decom-
position, which is the starting step towards Burdet’s regularization,
we deal with the displacement along the radial direction. In the
two-body problem, the second-order differential equation of the or-
bital radius can be linearized. Its solution contains two integration
constants (λ 1 ,λ 2 ) that are seen as the projections of a generalized
eccentricity vector on two orthogonal axes. This geometrical in-
terpretation leads to define an intermediate frame and thereby a
departure point on the osculating plane. The quantitiesλ 1 ,λ 2 ,the
total energyλ 3 , and the fictitious timeφdetermine the orbital radius
and the angle between the radial unit vector and the departure point.
In order to obtain the position, we just need to know the attitude of
the intermediate frame, and to this end, Euler parameters (denoted
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
New non-singular orbital elements 2893
byλ 4 ,λ 5 ,λ 6 ,λ 7 ) are employed. We show that these four elements
can be generated also from a VOP approach: the idea is to identify
a reference frame such that its angular velocity along a pure two-
body motion is constant with respect to the independent variableφ.
Then, Euler parameters associated with this frame obey linear first-
order differential equations, and their solution can be expressed in
terms of our four elements. To our knowledge, linearized equations
of Euler parameters have never been published before for a time
transformation in which the orbital radius has exponent one.
The motion in the variableφis completely described by the
elementsλ i , i =1... 7, and the physical time is determined from
Kepler’s equation by a time element. This set is non-singular at
zero inclination and eccentricity, works for negative values of the
total energy, and is undefined for collision orbits. A peculiar aspect
of the formulation is that the disturbing potential is required to
calculate the velocity, and, in particular, it must be independent on
the osculating angular momentum.

3 MOTIONINTHEORBITALPLANE
Let us consider a body of mass m (the propagated object) and denote
with r andvits position and velocity relative to an other body of
mass M (the primary). In a reference frame with the origin F at
the primary’s centre of mass and with fixed axes, the equation of
motion of the propagated object is

d^2 r
dt^2
=−
k^2 (m+M)
r^3
r + F , (3.1)
where k^2 is the gravitational constant,r=| r |is the orbital radius,
and t is the time variable. The first term on the right-hand side
represents the gravitational attraction exerted by the primary and
F (t, r ,v)is usually referred to as the perturbing force. The latter
can be expressed as

F =−
∂U
∂ r
+ P , (3.2)
whereU(t, r )is the disturbing potential energy per unit mass and
P (t, r ,v)includes the perturbations that do not arise from a dis-
turbing potential.
Let the vector h = r ×vbe the angular momentum per unit mass
andh=| h |. We introduce the orbital frameO={F; i , j , k }, with

k =
h
h
, i =
r
r
, j = k × i. (3.3)
In this orthonormal basis the velocity takes the form

v=

dr
dt
i +
h
r
j , (3.4)
and the components of the perturbing force are denoted by

R= F · i ,T= F · j ,N= F · k. (3.5)

For later use, we report below the angular velocity of the orbital
frame (Deprit 1975 , equation 14):

wO=N

r
h
i +
h
r^2
k. (3.6)
From here on, we shall adopt dimensionless quantities: the
units of length and time are chosen in such a way that the con-
stant k^2 ( m + M ) is replaced by 1, and m is taken as the unit
of mass. The proposed approach follows the idea inherited from
Burdet’s linearization of considering the motion as the composi-
tion of the radial displacement r along the unit vector i with the

rotation of i in space ( r , i are named projective coordinates after
Ferrandiz ́ 1988 ).
3.1 Radial motion
Let us compute the time derivative ofv(equation 3.4) taking ad-
vantage of (3.6), and plug the resulting expression into the left-hand
side of equation (3.1). After projecting this equation along the ra-
dial direction i and considering (3.5), we find that (Bauetal.` 2013 ,
equation 9)
d^2 r
dt^2
=
h^2
r^3
−
1
r^2
+R. (3.7)
In order to apply the VOP technique in an exact way we try to
transform (3.7) into a linear differential equation. To this end, we
first introduce a new independent variable, the fictitious timeφ,by
means of the time transformation
dt
dφ
=
r
√
− 2 ε
, (3.8)
whereε is the total energy which is expressed with the aid
of (3.4) as
2 ε=
(
dr
dt
) 2
+
(
h
r
) 2
−
2
r
+ 2 U. (3.9)
From here on, we make the hypothesis that the total energy is strictly
negative (ε<0). In the case of Keplerian motion the quantityφ
represents, up to an additive constant, the eccentric anomaly. The
radial velocity and acceleration can be written as
dr
dt
=
√
− 2 ε
r
dr
dφ
, (3.10)
d^2 r
dt^2
=
− 2 ε
r^2
[
d^2 r
dφ^2
−
1
r
(
dr
dφ
) 2 ]
−
1
r^2
dr
dφ
dε
dφ
. (3.11)
Next, the expression given in (3.10) is inserted in (3.9) and, by
rearranging the terms, we derive the useful relation
(
dr
dφ
) 2
=
h^2 + 2 r^2 U
2 ε
−r^2 −
r
ε
. (3.12)
Equations (3.11) and (3.12) are employed to transform (3.7) into
d^2 r
dφ^2
+r−λ 3 =(Rr− 2 U)λ 3 r+
1
2 λ 3
dλ 3
dφ
dr
dφ
, (3.13)
where we have introduced the generalized semimajor axis
λ 3 =−
1
2 ε
. (3.14)
The relation above is differentiated by use of (3.8) and of the well-
known formula for the time derivative of the total energy (see for
instance Stiefel & Scheifele 1971 , p. 11, equation 16, wherein h is
replaced by−ε)toget
dλ 3
dφ
= 2 λ^53 /^2 r
(
P ·v+
∂U
∂t
)
, (3.15)
with∂/∂tdenoting the partial derivative with respect to the phys-
ical time. Therefore, it is evident that the right-hand side of equa-
tion (3.13) vanishes when perturbations are not present (Uand P
are both equal to zero).
We conclude that by introducing the fictitious timeφthrough the
time transformation (3.8) and embedding the total energy integral in
the form provided by relation (3.12), we regularized equation (3.7)
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
2894 G. Bauetal.`
at least in the unperturbed part. This known result lays the ground
for introducing three orbital elements of the method proposed in
this paper.

3.2 The orbital elements λ 1 , λ 2 , λ 3

In absence of perturbations, equation (3.13) reduces to the linear
differential equation of an harmonic oscillator of unitary frequency
perturbed by the constantλ 3 :

d^2 r
dφ^2
=−r+λ 3. (3.16)
Therefore, we seek a solution of equation (3.13) in the form

r=λ 3 ( 1 −λ 1 cosφ−λ 2 sinφ), (3.17)

dr
dφ
=λ 3 (λ 1 sinφ−λ 2 cosφ), (3.18)
whereλ 1 andλ 2 are first integrals of the unperturbed motion. The
two relations above imply that the following condition must be
satisfied:

dλ 1
dφ
cosφ+
dλ 2
dφ
sinφ=
λ 3
dλ 3
dφ
, (3.19)
where we have introduced the quantity

= 1 −λ 1 cosφ−λ 2 sinφ. (3.20)

Moreover, according to the VOP method we substitute the solu-
tions (3.17) and (3.18) into equation (3.13) regardingλ 1 ,λ 2 ,λ 3 as
unknown functions ofφ. We obtain

dλ 1
dφ
sinφ−
dλ 2
dφ
cosφ=(Rr− 2 U)r−
ζ
2 λ 3
dλ 3
dφ
, (3.21)
where we have set

ζ=λ 1 sinφ−λ 2 cosφ. (3.22)

The system of equations (3.19) and (3.21) can be solved for the
derivatives ofλ 1 andλ 2 to yield

dλ 1
dφ
=(Rr− 2 U)rsinφ+
1
2 λ 3
dλ 3
dφ
[
( 1 + )cosφ−λ 1
]
,
(3.23)
dλ 2
dφ
=( 2 U−Rr)rcosφ+
1
2 λ 3
dλ 3
dφ
[
( 1 + )sinφ−λ 2
]
.
(3.24)
With the aid of equations (3.4), (3.10), (3.14), (3.17), and (3.18) we
convert (3.15) into

dλ 3
dφ
= 2 λ^53 /^2
(
Rpζ
√
λ 3 +Tph+
∂U
∂t
r
)
, (3.25)
whereRp= P · i ,Tp= P · j. Finally, the time transformation (3.8)
is conveniently rewritten as

dt
dφ
=λ^33 /^2 
. (3.26)
The quantitiesλ 1 ,λ 2 ,λ 3 are chosen as state variables of the
new formulation. They determine the radial distance and the radial
velocity (equations 3.17 and 3.18 together with equation 3.26) for a
given value of the independent variableφ, while, in general, they are
not sufficient to compute the magnitude of the angular momentum

( h ). In fact, from equations (3.12) and (3.14), (3.17), (3.18), we
derive the formula
h=
√
λ 3
(
1 −λ^21 −λ^22 − 2 Uλ 3
)
, (3.27)
where the disturbing potential energyUcan be a function of the
position and time. To completely characterize the dynamics of the
propagated body, we have to determine the physical time (Sec-
tion 4) and the evolution of the unit vectors i , j of the orbital frame
(Section 5).
4 TIME ELEMENT
The most straightforward way to compute the physical time is to
include it in the set of the state variables and to integrate equation
(3.26). An other possibility is to adopt a time element, which along
a Keplerian motion is constant or varies linearly with the fictitious
time (Bau & Bombardelli` 2014 ), thus reducing the instability of the
time integration.
We devise here a linear and a constant time element. The former is
similar to the one proposed in Stiefel & Scheifele ( 1971 , section 18)
for their regular set of elements. Let us consider the pure two-body
problem, that is P = 0 ,U=0. Then, the quantitiesλ 1 ,λ 2 ,λ 3 are
constants and the integration of equation (3.26) by separation of
variables yields the generalized Kepler’s equation
t=λ 0 ,l+λ^33 /^2 (λ 2 cosφ−λ 1 sinφ), (4.1)
where we have defined the time elementλ0, l as the sum of the
constant of integrationλ0, c and the term linear inφ:
λ 0 ,l=λ 0 ,c+λ^33 /^2 φ. (4.2)
Assuming now that the motion is perturbed we differentiate equa-
tion (4.1) and use (3.23)–(3.26) to derive
dλ 0 ,l
dφ
=λ^33 /^2
[
1 +(Rr− 2 U)r+
ζ
λ 3
dλ 3
dφ
]
, (4.3)
whereζis given in (3.22). A constant time element can be directly
defined from equation (4.2) as
λ 0 ,c=λ 0 ,l−λ^33 /^2 φ, (4.4)
and by exploiting (4.3) we easily compute the derivative ofλ0, c :
dλ 0 ,c
dφ
=λ^33 /^2
[
(Rr− 2 U)r+
1
λ 3
(
ζ−
3
2
φ
)
dλ 3
dφ
]
. (4.5)
Eitherλ0, l orλ0, c can be selected as one of our state variables.
Use of equation (4.1) in numerical propagations is discussed in
Section 6.
5 THE INTERMEDIATE FRAME
Following a similar approach to Bau & Bombardelli (` 2014 ), we
define the generalized eccentricity vector as
g =− i +w× c , (5.1)
wherewand c are the generalized velocity and angular momentum
vectors:
w=
dr
dt
i +
c
r
j , c =c k ,c=
√
h^2 + 2 r^2 U. (5.2)
The magnitude of g , which is computed from (5.1) and (5.2) by
taking into account of (3.10) and (3.12), reads
g=
√
1 + 2 εc^2 , (5.3)
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
New non-singular orbital elements 2895
Figure 1. The intermediate frame{F; x , y , k }as viewed from the k -axis
(see equation 3.3). The propagated object P occupies one point of the in-
stantaneous osculating ellipse with centre in C and one focus in F. The
generalized eccentricity vector g (equation 5.1) coincides with the osculat-
ing eccentricity vector e only ifU=0. In the case ofU=0theysharethe
same direction only ifddrt=0.

with 0≤ g <1. The orientation of g on the orbital plane can be
represented by the generalized true anomalyθ:

gcosθ=

c^2
r
− 1 ,gsinθ=c
dr
dt
. (5.4)
The angleθis reckoned from g up to the radial direction i anti-
clockwise with respect to k (see Fig. 1 ).
In analogy with the definition of the osculating eccentric anomaly,
we can introduce the generalized eccentric anomaly G as follows:

gcosG= 1 + 2 εr, gsinG=− 2 ε

dr
dφ
. (5.5)
After replacing r ,ddφrin equations (5.5) with the expressions given
in (3.17) and (3.18), and recalling (3.14), we find forλ 1 andλ 2 these
compact formulae:

λ 1 =gcos(φ−G), (5.6)

λ 2 =gsin(φ−G). (5.7)

They represent the projections of g along two orthonormal vectors,
denoted by x and y :

g =λ 1 x +λ 2 y. (5.8)
Next, we impose the condition x × y = k ,where k is perpendicular
to the orbital plane (see 3.3), and introduce the intermediate frame
I={F; x , y , k }. The direction of x locates the departure point from
which we measure the longitudeνof the propagated object (Fig. 1 ).
From the definition ofθ(given in 5.4) and the relations (5.6)–(5.8)
we have

x = i cosν− j sinν, (5.9)
y = j cosν+ i sinν, (5.10)
where the unit vectors i , j belong to the orbital frameO(see 3.3)
and

ν=φ+θ−G. (5.11)

Figure 2. Same as Fig. 1 but for the caseU=0. The angles G andθof
Fig. 1 become the osculating eccentric ( E ) and true ( f ) anomaly, respectively.
Therefore, the relative angular velocity ofIwith respect toOis
ωIO=−
dν
dt
k , (5.12)
and its absolute angular velocity results
ωI=ωO+ωIO=N
r
h
i +
(
h
r^2
−
dν
dt
)
k , (5.13)
where N andωOare given in (3.5) and (3.6). For later reference, let
us introduce
ω=
dt
dφ
ωI. (5.14)
As will be clear once we provide the expression forddνφ(equation
5.20), the intermediate frameIis not an ideal frame (according to
the definition of Deprit 1976 ) since the component of the angular
velocityωIalong k is not identically zero. Besides, the attitude of
Iis influenced, in general, not only by N , as for the ideal frames
developed in Deprit ( 1975 )andPel ́aez et al. ( 2007 ),butalsobythe
in-plane projections of F (i.e. R and T , see 3.5).
The intermediate frame has a simple geometrical interpretation
if the disturbing potential energyUis zero (Fig. 2 ). In this case, the
generalized quantities introduced so far convert into their osculating
counterparts. Hence, at a given epoch, G is the osculating eccentric
anomaly andφ− G represents the angular separation between the
unit vector x and the osculating eccentricity vector e.
5.1 The orbital elements λ 4 , λ 5 , λ 6 , λ 7
The orbital basis{ i , j , k }can be determined from the longitude
νand the attitude of the intermediate basis{ x , y , k }by applying
relations (5.9) and (5.10).
We show in Appendix A that the angleν(equation 5.11) is the
following function ofλ 1 ,λ 2 ,λ 3 ,andφ:
ν=φ+2 arctan
(
ζ
√
1 −λ^21 −λ^22 +
)
, (5.15)
where andζwere defined in equations (3.20) and (3.22). As
concerns the intermediate frameI, we select four Euler parameters,
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
2896 G. Bauetal.`
denoted byλ=(λ 4 ,λ 5 ,λ 6 ,λ 7 )Tto represent its attitude in space.
The evolution ofλis governed by the differential equation

dλ
dφ
=
1
2
⎛
⎜
⎜
⎝
0 ωz −ωy ωx
−ωz 0 ωx ωy
ωy −ωx 0 ωz
−ωx −ωy −ωz 0
⎞
⎟
⎟
⎠λ, (5.16)
whereω x ,ω y ,ωzare the projections of the angular velocityω
(equation 5.14) along the axes ofI:

ωx=ω· x =N

r^2
n
cosν, (5.17)
ωy=ω· y =N

r^2
n
sinν, (5.18)
ωz=ω· k =

n
−
dν
dφ
, (5.19)
beingn=√hλ 3 with h given in (3.27). In equations (5.17) and (5.18)
the longitudeνtakes the expression shown in equation (5.15). More-
over, the derivativeddνφin (5.19) is provided by the formula (the
derivation is detailed in Appendix A)

dν
dφ
=
m
+
1
m( 1 +m)
[
( 2 U−Rr)( −m− 2 )r
+
ζ(m− )
2 λ 3
dλ 3
dφ
]
, (5.20)
where R is the radial component of the perturbing force vec-
tor (see 3.5) and m is the auxiliary variable reported in
(6.11). Note that in the case of Keplerian motion we have
ω= 0 and from (5.16) the four Euler parameters inλare con-
stants. We chooseλ i , i =4... 7, as the remaining state variables
of our formulation. In the next subsection, we will show that these
elements can be generated by following a completely different ap-
proach, which relies on a new set of linear differential equations of
the unperturbed two-body problem.

5.2 Alternative derivation

Let us rotate the orbital frame (see 3.3) around the direction of k
by the angleθ− G , where the generalized anomaliesθand G were
introduced in (5.4) and (5.5), respectively, and define the vectors

x ∗= i cos(θ−G)− j sin(θ−G), y ∗= k × x ∗. (5.21)

Noting thatθ− G =ν−φ(see equation 5.11) and recalling the
meaning ofω(equation 5.14), the angular velocity vector of the
frameI∗={F; x ∗, y ∗, k }in the fictitious timeφcan be written as
ω∗=ω+ k .Along a Keplerian orbit we haveω∗= k ,sothat

d x ∗
dφ
= y ∗,
d y ∗
dφ
=− x ∗, (5.22)
and each component of the unit vector x ∗is the solution of an
harmonic oscillator of frequency equal to one. Equations (3.16),
(5.22), and

dλ 0 ,l
dφ
=λ^33 /^2 ,
dλ 3
dφ
= 0 , (5.23)
(λ0, c can be taken instead ofλ0, l ) form a tenth-order linear system
whose solutions are Lyapunov stable, and which is equivalent to
the non-linear equation (3.2) when F = 0. The system represented
by equations (3.16) and (5.22) is analogous to the one derived by
Burdet ( 1969 ) for the inverse orbital radius and the radial unit vector,

and, as far as we know, has never been presented before. Then, we
consider four Euler parametersλ∗=(λ∗ 4 ,λ∗ 5 ,λ∗ 6 ,λ∗ 7 )Tlinked with
the frameI∗. Along a Keplerian orbitλ∗obeys the linear differential
equation
dλ∗
dφ
=
1
2
⎛
⎜
⎜⎝
01 00
−10 00
00 01
00 − 10
⎞
⎟
⎟⎠λ∗, (5.24)
and its solution reads
⎛
⎜⎜
⎜⎜
⎝
λ∗ 4
λ∗ 5
λ∗ 6
λ∗ 7
⎞
⎟⎟
⎟⎟
⎠
=cos
φ
2
⎛
⎜⎜
⎜⎜
⎝
λ 4
λ 5
λ 6
λ 7
⎞
⎟⎟
⎟⎟
⎠
−sin
φ
2
⎛
⎜
⎜⎜
⎝
λ 5
−λ 4
λ 7
−λ 6
⎞
⎟
⎟⎟
⎠
, (5.25)
whereλ i , i =4... 7, are constants of integration. Equations (5.25)
reveal that such constants are Euler parameters associated with a
certain frameI, and that a rotation ofφaround k bringsIto coincide
withI∗. Therefore, from equations (5.9)–(5.11) and (5.21) we infer
thatIis the intermediate frame{F; x , y , k }and so the quantities
λ i , i =4... 7, are the orbital elements employed in our method.
A final remark concerns equation (5.24): to our knowledge, linear
differential equations of Euler parameters in the two-body problem
have never been obtained with a classical Sundman transformation
of the physical time (i.e. linear in the orbital radius).
6 IMPLEMENTATION OF THE METHOD
The method consists of a time element and seven spatial elements.
Four Euler parameters track the evolution of an intermediate frame,
which, in analogy to Hansen’s ideal frame (Deprit 1975 ), specifies
the orientation of the orbital plane and of a reference direction on
it ( x ), called departure point. Other three elements together with
the independent variable fix the angle between x and the radial
unit vector i , and characterize the motion along i. The last missing
information is about the magnitude of the angular momentum. In
general, this is a function of the whole set of elements through the
disturbing potential energyU(see equation 3.27).
In this section, we write the eight differential equations in a
suitable form to the implementation in a computer program. Then,
we show how to pass from the orbital elements to the position and
velocity and vice versa, since these are necessary operations in a
numerical propagation.
6.1 Differential equations
We collect below the differential equations of the eight variables of
the new method (equations 4.3, 3.23, 3.24, 3.25, 5.16):
dλ 0 ,l
dφ
=λ^33 /^2 [ 1 +(Rr− 2 U)r+ 2  3 ζ], (6.1)
dλ 1
dφ
=(Rr− 2 U)rsinφ+ 3
[
( 1 + )cosφ−λ 1
]
, (6.2)
dλ 2
dφ
=( 2 U−Rr)rcosφ+ 3
[
( 1 + )sinφ−λ 2
]
, (6.3)
dλ 3
dφ
= 2 λ^33
(
Rpζ+Tpn+
∂U
∂t
√
λ 3
)
, (6.4)
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
New non-singular orbital elements 2897
d
dφ
⎛
⎜
⎜⎜
⎜
⎝
λ 4
λ 5
λ 6
λ 7
⎞
⎟
⎟⎟
⎟
⎠
=N
r^2
2 n
⎛
⎜
⎜⎜
⎜
⎝
λ 7 cν−λ 6 sν
λ 6 cν+λ 7 sν
−λ 5 cν+λ 4 sν
−λ 4 cν−λ 5 sν
⎞
⎟
⎟⎟
⎟
⎠
+
ωz
2
⎛
⎜
⎜⎜
⎜
⎝
λ 5
−λ 4
λ 7
−λ 6
⎞
⎟
⎟⎟
⎟
⎠
, (6.5)
where (equations 3.17, 5.15, 5.19, 5.20)

r=λ 3 , (6.6)

cν=cosν, sν=sinν, ν=φ+2 arctan

(
ζ
m+
)
, (6.7)
ωz=

n−m
+
1
m( 1 +m)
[
( 2 U−Rr)( 2 − +m)r
+ 3 ζ( −m)
]
, (6.8)
and

 3 =

1
2 λ 3
dλ 3
dφ
, (6.9)
= 1 −λ 1 cosφ−λ 2 sinφ, ζ=λ 1 sinφ−λ 2 cosφ, (6.10)

n=

√
m^2 − 2 λ 3
2 U,m=
√
1 −λ^21 −λ^22. (6.11)
Sinceνappears only as argument of trigonometric functions, it is
possible to avoid equation (6.7) and directly employ the expressions

cν=cosφ−λ 1 +

ζλ 2
m+ 1
,
sν=sinφ−λ 2 −
ζλ 1
m+ 1
. (6.12)
Moreover, given the perturbing force F (equation 3.2) we have

R= F · i ,N= F · k ,Rp= P · i ,Tp= P · j , (6.13)

where i , j , k are obtained as shown in Section 6.2. Note that we
report only the differential equation of the linear time elementλ0, l
(equation 6.1), but one may employ insteadλ0, c (equation 4.5) or
the physical time (equation 3.26).
The system (6.1)–(6.5) holds for negative values of the total en-
ergy (ε). Additionally, we require that the potentialU(t, r )satisfies
c^2 >0, where c is the generalized angular momentum (see 5.2; this
issue is discussed in Bauetal. 2013 , section 6). The conditionsε< 0and _c_ =0 imply that (0≤) _g_ <1 (see equation 5.3), and, since _m_^2 = 1 − _g_^2 (from equations 5.6, 5.7, 6.11), we have in particular _m_ =0, thus avoiding the singularity in (6.8). Finally, equation (6.5) become singular when _h_ =0. _Remark._ In both methods presented in this work and in Bau
et al. ( 2013 ) the disturbing potential energyUisassumedtobe
independent on the velocityv. However, this hypothesis could be
relaxed since what we really ask is thatUis independent on the
osculating angular momentum h , which enters the component of
valong j (see equations 3.4, 3.27, and equation 45 in Bauetal.`
2013 ).

6.2 Computation of the position, velocity, and time from the
orbital elements and from the independent variable

The components of the unit vectors x , y , k of the intermediate frame
along three orthonormal axes with fixed directions can be written
in function of the Euler parametersλ i , i =4...7,as

x = 2
(
1
2
−λ^25 −λ^26 ,λ 4 λ 5 +λ 6 λ 7 ,λ 4 λ 6 −λ 5 λ 7
)T
, (6.14)
y = 2
(
λ 4 λ 5 −λ 6 λ 7 ,
1
2
−λ^24 −λ^26 ,λ 5 λ 6 +λ 4 λ 7
)T
, (6.15)
k = 2
(
λ 4 λ 6 +λ 5 λ 7 ,λ 5 λ 6 −λ 4 λ 7 ,
1
2
−λ^24 −λ^25
)T
. (6.16)
Then, we get the radial and transverse unit vectors i and j from
i = x cosν+ y sinν, (6.17)
j = y cosν− x sinν, (6.18)
where cosνand sinνare provided by equations (6.12).
The (dimensionless) position vector reads
r =λ 3 ( 1 −λ 1 cosφ−λ 2 sinφ) i. (6.19)
If a linear (λ0, l ), constant (λ0, c ) time element is employed then the
(dimensionless) physical time is computed as
t=λ 0 ,l−λ^33 /^2 (λ 1 sinφ−λ 2 cosφ), (6.20)
t=λ 0 ,c−λ^33 /^2 (λ 1 sinφ−λ 2 cosφ−φ), (6.21)
respectively.
Finally, we get the (dimensionless) velocity vector from the relation
v=vr i +vt j , (6.22)
where the radial and transversal components are
vr=
λ 1 sinφ−λ 2 cosφ
√
λ 3
,vt=
√
1 −λ^21 −λ^22
λ 3
− 2 U, (6.23)
with given in (6.10).
6.3 Computation of the orbital elements from the position,
velocity, and time
We assume to know the (dimensionless) physical time t , position,
and velocity vectors ( r ,v) in the frameF={F; e 1 , e 2 , e 3 }having
fixed axes in space.
The corresponding total energy and angular momentum vector
are
ε=
v^2
2
−
1
r
+U, h = r ×v, (6.24)
wherer=| r |andv=|v|. The generalized angular momentum is
given by
c=
√
h^2 + 2 r^2 U, (6.25)
withh=| h |. Among the possible values of the independent variable
φwe suggest (2ε c^2 =−1)
φ=G=atan
(
r ·v
√
− 2 ε, 1 + 2 εr
)
, (6.26)
where G is the generalized eccentric anomaly (equation 5.5). This
choice implies (equations 5.3, 5.6, 5.7)
λ 1 =
√
1 + 2 εc^2 ,λ 2 = 0. (6.27)
For a generic value ofφthe elementsλ 1 andλ 2 are calculated
through the formulae
λ 1 =( 1 + 2 εr)cosφ+ r ·v
√
− 2 εsinφ, (6.28)
λ 2 =( 1 + 2 εr)sinφ− r ·v
√
− 2 εcosφ. (6.29)
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
2898 G. Bauetal.`
Moreover, we have

λ 3 =−

1
2 ε
, (6.30)
and the time element is recovered by

λ 0 ,l=t+λ^33 /^2 (λ 1 sinφ−λ 2 cosφ), (6.31)

λ 0 ,c=t+λ^33 /^2 (λ 1 sinφ−λ 2 cosφ−φ). (6.32)

In order to determine the remaining elements, we first compute the
angleν,

ν=φ+2 arctan

(
r ·v
c+r
√
− 2 ε
)
. (6.33)
Then, we obtain the unit vectors x , y , k of the intermediate frame:

x = i cosν− j sinν, y = j cosν+ i sinν, k =

h
h
, (6.34)
where

i =

r
r
, j = k × i. (6.35)
Finally, from the components of x , y , k in the fixed frameFwe
can express the quantitiesλ 4 ,λ 5 ,λ 6 ,λ 7 by the relations

λ 7 =

1
2
√
1 +x 1 +y 2 +k 3 , (6.36)
λ 4 =

y 3 −k 2
4 λ 7
,λ 5 =
k 1 −x 3
4 λ 7
,λ 6 =
x 2 −y 1
4 λ 7
, (6.37)
where, for a generic vector a , we meanaα= a · e α,α=1, 2, 3. The
singular caseλ 7 =0isdiscussedinAppendixB.

7 NUMERICAL COMPARISONS
The method presented in the previous sections is used to calculate
the special perturbations of a small body orbiting around a primary
body of attraction. The performance of the new formulation is com-
pared with that of many others for three examples. The details of
the numerical investigation and the comments on the results are
reported below.
7.1 Formulations
Three different algorithms of the new method were implemented
by combining the quantitiesλ 1 ...λ 7 with either the physical time
or a linear, constant time element. In the numerical tests several
formulations of the perturbed two-body problem were compared.
Those for which the state vector is made only by orbital elements
are(seeTable 1 ): the Stiefel–Scheifele regular variables (Stiefel
& Scheifele 1971 , section 19); Stiefel’s spatial elements (Stiefel
et al. 1967 , p. 18) completed by a constant time element (Arakida
& Fukushima 2001 , appendix); a new version of Stiefel’s elements
(named Stiefel*) provided with a constant, linear time element (see
Appendix C); Dromo(PC) and Dromo(PL) (Bau & Bombardelli`
2014 ). We included also the method Dromo(P) (Bauetal.` 2013 ),
in which the physical time is a state variable. Two versions of each
Dromo scheme were coded depending on whether the total en-
ergy (ε, see equation 3.9) or the generalized angular momentum
( c , see 5.2) is adopted as one of the state variables. The following
methods that rely mainly on coordinates (see Table 1 ) are consid-
ered: the Kustaanheimo-Stiefel regularization (Stiefel & Scheifele
1971 , section 9); the stabilized Cowell’s method invented by Baum-
garte ( 1972 ), with or without a time element (the former version
wastestedbyJanin 1974 ); different implementations of the Burdet–
Ferr ́andiz (B–F) regularization. More specifically, we tested the B–F
method as it is reported in appendix C.2 of Fukushima (2007a), and
Table 1. Formulations included in the numerical tests (a brief description is reported in Section 7.1). The
independent variable is denoted by s and the physical time by t. The quantities r , h , c ,andεare the orbital radius,
the osculating angular momentum, the generalized angular momentum (see 5.2), and the total energy. In the
performance plots the labels Dromo(P), Dromo(PC), Dromo(PL) are followed by either c or e to inform that^1 c
andε, respectively, is a state variable. The same notation is applied to the labels BF*, BF*(C), BF*(L) to indicate
the use of c andεin the state vector.
Time element
Formulations Independent variable Dim. a Time Constant Linear
Based on orbital elements
New ()
√
− 2 εdt=rds 8x
New(C) ()8 x
New(L) ()8 x
Sti&Sche ()10 x
Stiefel(C) ()d t = r d s 10 x
Stiefel*(C) ()10 x
Stiefel*(L) ()10 x
Dromo(P) () c d t = r^2 d s 8x
Dromo(PC) ()8 x
Dromo(PL) ()8 x
Based on coordinates
KS ()10 x
CowS ()8x
CowS(L) ()8 x
BF h d t = r^2 d s 10 x
BF* ()10x
BF*(C) ()10 x
BF*(L) ()10 x
a This is the dimension of the state vector.
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
New non-singular orbital elements 2899
the modified version (named BF) shown in Appendix C, where
a constant and a linear time element are also supplied. For BF,
BF(C), BF(L) we took into account the possibility of employing
the total energy as a state variable instead of the element c .Table 1
contains some relevant details of all these formulations, which will
be referred to as indicated in the first column of this table.

7.2 Numerical integrators

The formulations of the previous subsection were paired to a single-
step and a multistep numerical integrator (Henrici 1962 ). Among
the one-step methods we selected the Runge–Kutta (4, 5) pair of
Dormand & Prince ( 1980 ), hereafter called DOPRI54, as coded
in theMATLABfunction ode45.m. An important feature is that the
length of the step size is controlled by relative and absolute toler-
ances. One multistep method that we used for the numerical tests
consists in the Adams–Bashforth and the Adams–Moulton formu-
lae in the summed form (Montenbruck & Gill 2000 , equations 4.
and 4.96) implemented in a PECE (predict, evaluate, correct, eval-
uate) scheme. This algorithm, which will be referred to as ABM,
and the DOPRI54, can be applied to any formulation in Table 1.
The methods based on coordinates were also combined with an
other multistep integrator. For these schemes the state vector takes
the form

(
q ; q ′; z
)
,where q ′=dd q sand s is the independent vari-
able. The vector q is governed by a second-order differential equa-
tion and its propagation is carried out by Stormer’s and Cowell’s ̈
methods of order p in PECE mode. Secund-sum formulae, known
as Gauss–Jackson methods, are employed (Montenbruck & Gill
2000 , equations 4.93 and 4.94). The variables contained in z and
q ′obey first-order differential equations and are obtained by the
ABM method of order p and p −1, respectively. We call this multi-
step algorithm SC-ABM. Both the ABM and SC-ABM integrators
employ a fixed step size. Finally, the starting values are provided
by an implicit Runge–Kutta method of order p based on Gaussian
quadrature formulae (see Hairer, Nørsett & Wanner 2009 ,vol.1,
p. 208, and references therein).

7.3 Performance metrics

Let us call propagator the combination of a formulation and a nu-
merical integrator. In order to evaluate its performance, we resort to
two numerical tests. The first one measures the computational cost
required to achieve a certain level of accuracy. The motion is prop-
agated from some given initial conditions until the physical time
(which is not the independent variable for any of the selected for-
mulations) reaches the desired value t ref. If the position of the object
is known at the time t ref, and for sufficiently short propagations, we
can take the distance between the computed and the reference posi-
tions as a measure of the achieved accuracy. The computational cost
is represented by the total number of evaluations of the right-hand
side of the differential equations (functions calls) for the DOPRI54,
and by the total number of steps for the ABM and SC-ABM. By
changing the step length in the multistep methods and the tolerances
of the DOPRI54, which in turn control the number of function calls,
we can explore the behaviour of a specific propagator. The correct
position at t refis assessed as follows. Accurate propagations are car-
ried out with a subset of formulations and the DOPRI54 integrator
setting the absolute^5 and relative tolerances to a sufficiently small
value (10−^13 ). Then, the common figures in each component of the

(^5) In this work, we always assign the same value of the absolute tolerance to
all the components of the state vector.
final position vectors constitute the reference position. In one of
the proposed examples (Example 3), the computational cost is also
measured by the time spent to propagate the state vector from the
initial to the final epoch.
The second performance metric is the accumulation of the er-
ror in position, time, and possible conserved quantities over a few
thousand nominal periods around the primary body. With nomi-
nal period, we mean the period of the initial osculating orbit of the
propagated object. The numerical integrators used in this test are the
multistep methods ABM, SC-ABM, and the error is calculated with
the same procedure outlined in section 3.3 of Bau & Bombardelli`
( 2014 ). We will show the error obtained by a moving average filter
with a window size of N +1, where N is the number of steps per
nominal period.
7.4 Examples and results
An example is given by the initial conditions of the propagated ob-
ject relative to a primary body, and by the model of the perturbations.
In general, for a certain example we carry out the two numerical
tests described in the previous subsection with all the available prop-
agators. In the first test, we compare separately the results produced
by the one-step and the multistep methods. Each formulation based
on coordinates is combined with both the ABM and the SC-ABM,
and the better behaviour of the two pairs is considered. Apart from
Sti&Sche and KS, the other schemes can be divided into five groups
(Table 1 ). Only the most efficient propagator of each group is shown
in the following plots.
We propose three examples: the first two present simplified mod-
els of weak and moderate gravitational perturbations, respectively;
the third one describes a more realistic scenario of motion around
the Earth including also non-gravitational forces.
7.4.1 Example 1
The asteroid 1566 Icarus is propagated under the perturbation of
Jupiter. The initial conditions of Icarus and Jupiter are expressed
by the classical orbital elements reported in Table 2 .Thevalues
are taken from Fukushima (2007b) with the exception of Jupiter’s
eccentricity, which is assumed to be zero. Since Jupiter is influenced
only by the gravity of the Sun we have a restricted circular three-
body problem and thereby the conservation of the Jacobi constant.
This example represents the case of a weak perturbation: the mean
value of the ratio between the accelerations exerted by Jupiter and
the Sun is of the order of 10−^4.
Fig. 3 shows the average errors in position, time, and Jacobi con-
stant over an interval of the independent variable corresponding to
ten thousand nominal periods along Icarus’ initial osculating orbit.
A similar test is reported in Fukushima (2004a,b) where the au-
thor plots the error in the mean longitude at epoch. The third-body
perturbation due to Jupiter is an explicit function of the physical
time and is here regarded as the force P in equation (3.2). Note
that the disturbing potential energy is zero in this case and so the
Table 2. Initial Keplerian elements of Icarus and Jupiter referred to the
heliocentric ecliptic coordinate system at epoch J2000.0.
a (au) ei (◦) (◦) ω(◦) M 0 (◦)
Icarus 1.078 0.827 22.9 88.1 31.3 323.
Jupiter 5.2026 0.0 1.303 100.471 14.337 95.
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025

2900 G. Bauetal.`
Figure 3. Position, time, and Jacobi constant error accumulated during 10000 nominal periods; example 1: Icarus perturbed by Jupiter. The new method is
compared with the formulations based on elements (left-hand) and on coordinates (right-hand). The numerical integrators are the 10th-order multistep methods
ABM, SC-ABM, and the number of steps per nominal period is 90. To avoid superpositions, the curves are shifted along the vertical axis by a suitable power
of 10 when necessary.

formulations Stiefel(C) and BF in Table 1 are equivalent to
Stiefel(C) and BF, respectively.
A first consideration rising from Fig. 3 is that the formulations
employing a time transformation of order two (i.e. quadratic in the

orbital radius, see Table 1 ) show the worse performance. All the
other methods use time transformations linear in the orbital radius,
and accumulate almost the same amount of error in position, which
is of the order of 1 km at the end of the propagation. However, only
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
New non-singular orbital elements 2901
Figure 4. Function calls versus position error after 288.12768941 msd (about 49.5 revolutions); example 2: artificial satellite of the Earth perturbed by J 2 ,
Moon. The numerical integrator is the 5th-order explicit Runge–Kutta method (DOPRI54). The relative tolerance is changed from 10−^6 to 10−^10 ,andthe
absolute tolerance is set to 10−^13. The new method is compared with the formulations based on elements (left-hand) and on coordinates (right-hand).

New exhibits a linear growth, in the range between 10 and 3000
nominal periods. The evolutions of the time and position errors
are very similar to each other for all the propagators, thus indicat-
ing how an accurate prediction of the physical time is mandatory
to improve the performance of regularized formulations (Ba`u&
Bombardelli 2014 ). In Fig. 3 , we also display the difference be-
tween the Jacobi constant computed at each integration step and
the nominal value obtained from the initial conditions. We advise
that, in general, monitoring only the conservation of one integral
of the motion (when it exists) is not sufficient for ranking different
formulations, but can be useful to reveal further characteristics of
the error. For example, the linear growth of CowS(L) suggests that
a faster deterioration of the position accuracy will occur beyond
the considered range of propagation with respect to KS and New,
which instead exhibit an almost constant trend. In conclusion, the
new method enjoys the most favourable behaviour of the error so
that an increasing advantage with respect to the other methods is ex-
pected for numerical integrations longer than ten thousand nominal
periods.

7.4.2 Example 2

The initial position and velocity of an artificial satellite with respect
to the geocentric equatorial coordinate system (F)are

r =(0,− 5888. 9727 ,−3400)Tkm,
v=(10. 691338 , 0 ,0)Tkm s−^1.
(7.1)
The eccentricity and inclination of the Keplerian orbit are about
0.95◦and 30◦, and the spacecraft occupies the perigee at a distance
of 6800 km from the Earth’s centre of mass. Two perturbations are
active: the Moon’s gravitational attraction and the Earth’s oblate-
ness. The former is included in the force denoted by P in equa-
tion (3.2), while for the latter we introduce the disturbing potential
containing the zonal harmonic J 2. This example was invented by
Stiefel & Scheifele ( 1971 , p. 118) to test their set of regular ele-
ments. Moreover, it was considered for numerical experiments in
Bau & Bombardelli (2014 )andBau et al. ( 2013 ) where one can find
the formulae to implement the perturbing forces and the values of
the related constants.

In the first test, we investigate the relation between the accuracy
in the position at a given epoch and the computational cost. Let us
pick as reference time 288.12768941 mean solar days (msd) elapsed
from the initial epoch (as in the examples 2a and 2b of Stiefel &
Scheifele 1971 , p. 122), which corresponds to a final position close
to the farthest point from the Earth of the 50th revolution. Assume
that the correct coordinates of the satellite in the reference frameF
are given by^6
r ref=(− 24219. 0501 ,− 227962. 10637 , 129753 .44240)Tkm.
(7.2)
This vector is taken from table 2 of Bau et al. (` 2013 )andit
was obtained as described in Section 7.3 by employing the meth-
ods Dromo(P)a, Dromo(P)e, Sti&Sche, and the set of elements of
Sperling–Burdet (Bond & Allman 1996 , chapter 9). Fig. 4 dis-
plays the variation in the position error as the relative tolerance
of the numerical integrator DOPRI54 is modified inside a suit-
able range thus producing a consequent variation of the number of
function calls. In the case of the multistep methods ABM, SC-ABM
(Fig. 5 ) we increase the number of steps per revolution starting from
the minimum quantity that does not lead to numerical instability.^7
The proposed method is the most efficient both with a variable and
a fixed step-size integrator, since it requires, in general, the smallest
computational effort for a given accuracy.
The performance in a long-term propagation, here of five thou-
sand nominal periods, is shown in Fig. 6. Dromo(PL)e and BF*(L)e
exhibit a huge initial jump of the error in position and time followed
by a quadratic growth. The errors produced by the new method re-
main almost constant in the first two hundred periods, then they start
growing according to a 3/2 power law. It is notable that, in spite
of the linear behaviour of the other formulations, New reaches the
smallest amount of error at the end of the propagation. In particular,
it is more accurate than KS and Sti&Sche of one and two orders of
magnitude, respectively.
(^6) Note that the components of the vector r refare assumed to be correct up
to the shown decimal digits.
(^7) Here and in the example 3, we used a minimum threshold of 32 steps per
revolution.
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025

2902 G. Bauetal.`
Figure 5. Number of steps per revolution versus position error after 288.12768941 msd; example 2. The numerical integrators are the 10th-order multistep
methods ABM, SC-ABM. The total number of steps is given by steps/rev times 49.5.

Figure 6. Position and time error accumulated during 5000 nominal periods; example 2: artificial satellite of the Earth perturbed by J 2 , Moon. The new method
is compared with the formulations based on elements (left-hand) and on coordinates (right-hand). The numerical integrators are the 10th-order multistep
methods ABM, SC-ABM, and the number of steps per nominal period is 144.

Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
New non-singular orbital elements 2903
Table 3. Reference positions (in the geocentric equatorial coordinate sys-
tem) at two physical times (in mean solar days elapsed from the initial epoch)
for the example 3. These values were found with the procedure described in
Section 7.3 and employing the methods New, Sti&Sche, KS, CowS(L).

Time intervals (msd) Reference positions (km)

( t ref,1) 288.01603946 (−21 572.282, 226401.054, 128 935.148) T
( t ref,2) 291.49486175 (−15 477.46,−2591.82,−1936.21) T

7.4.3 Example 3

Let us consider the same initial conditions (see 7.1) and pertur-
bations ( J 2 , Moon) as in the example 2, and include also the non-
gravitational forces due to the direct solar radiation pressure and the
atmospheric drag. The latter is implemented as described in section
7.1.3 of Bau et al. (` 2013 ). We just point out that the exponential
model is adopted for the atmospheric density and the hypothesis of
a compact spacecraft in free molecular flow is made. Moreover, the
ratio between the cross-sectional area orthogonal to the velocity rel-
ative to the atmosphere and the spacecraft mass ( m ) is 0.01 m^2 kg−^1.
As concerns the radiation pressure, we use the cannonball model
and the acceleration is computed by (Milani & Gronchi 2010 ,
p. 289)

P rp=−

c
A
m
s =−Prp s , (7.3)
where c is the speed of light,/ c is the flux of momentum per unit
cross-sectional area,Ais the effective cross-sectional area, and s
identifies the direction to the Sun. We assume that P rpis constant
and equal to 10−^10 km s−^2 , which is a reasonable value for an Earth
satellite with an area to mass ratio of 0.01 m^2 kg−^1 (Montenbruck
& Gill 2000 , p. 55). For simplicity let the Sun–spacecraft line be
parallel to the Sun–Earth line. Then, if the Earth follows a circular
orbit (with radius of one astronomical unit), the vector s can be
written in the geocentric equatorial coordinate systemFas

s =(−sin(wt),cos(wt)cosε,cos(wt)sinε)T, (7.4)
where t is the physical time,εandware the Earth’s obliquity (we
take 23.4◦) and orbital angular velocity.

Let us fix two epochs such that the spacecraft is near to the
apogee and perigee of the corresponding osculating orbits (see
Table 3 ). Note that the same error in physical time produces a
bigger displacement of the position in the latter case due to the
faster motion. Fig. 7 shows for the two considered time intervals
the position error and the function calls as the relative tolerance
of the numerical integrator DOPRI54 is gradually decreased. We
found that the formulations relying on orbital elements have compa-
rable efficiency, and, in general, they outperform the methods based
on coordinates. A desirable feature of our scheme is that it involves
a low computational cost also for very accurate propagations (see
Table 4 ). A linear time element proves to be beneficial in this sense,
and we see that New(L) requires 2, 3, and 7 times less evaluations
of the right-hand side than the Stiefel–Scheifele elements, the KS
regularization, and the stabilized Cowell’s method, respectively.
Next, we analyse the efficiency of the formulations paired with
a multistep method. In this case we shorten the step size starting
from a maximum length which is determined by applying the same
criterion of the example 2. Tables 5 and 6 summarize the results for
the two time intervals t ref,1and t ref,2of Table 3. As long as the number
of steps per revolution (steps/rev) is sufficiently low (for example
160) the methods exploiting a classical Sundman transformation
are much more accurate. However, we observe that they encounter
a sort of accuracy barrier which prevents a substantial improvement
passing from 320 to 640 steps/rev. On the other hand, by doubling
the number of integration steps the error is progressively reduced
in Dromo(PC)e, BF*(L)a, BF*a, and for 640 steps/rev it becomes
two orders of magnitude smaller with respect to the other methods.
These different behaviours can be explained by the fact that in
time transformations of the form d t =α rn d s (α∈R+,n∈Z+)the
choice n =2against n =1 produces a denser distribution of points
near the Earth, especially if the eccentricity is high, and thereby
allows a better propagation in the region where the atmospheric
drag is active. Considering the computational time spent during the
integration (Table 5 ), we can state that in the example 3 and for short-
term propagations Dromo(PC)e achieves the highest accuracy with
the smallest effort if we employ a fixed step-size multistep method.
Finally, the evolution of the position error until five thousand
nominal periods is shown in Fig. 8. As we expected the error is
Figure 7. Function calls versus position error after about 49.5 (left-hand) and 50 (right-hand) revolutions (the exact intervals of time are given in Table 3 );
example 3: artificial satellite of the Earth perturbed by J 2 , Moon, solar radiation pressure, atmospheric drag. The numerical integrator is the 5th-order explicit
Runge–Kutta method (DOPRI54). The relative tolerance is changed from 10−^5 to 10−^9 and the absolute tolerance is set to 10−^13. Since the formulations that
use orbital elements exhibit similar performance, only the curves of New(C) are displayed.

Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
2904 G. Bauetal.`
Table 4. Example 3; total number of function calls for a very accurate propagation until the epoch t ref,
(Table 3 ). The relative and absolute tolerance of the numerical integrator DOPRI54 are both set to 10−^13 .In
the brackets, the computational cost is normalized with respect to the function calls of New(L). We report only
the methods for which the distance between the final and reference positions is between 0.7 and 1.3 m.
Formulations Function calls Formulations Function calls
New(L) 63715 (1) Dromo(PC)a 189475 (2.97)
New 64375 (1.01) KS 191317 (3.00)
Dromo(PL)e 76627 (1.20) Stiefel(C) 228379 (3.58)
Stiefel*(L) 115663 (1.82) BF*(L)e 357547 (5.61)
New(C) 130423 (2.05) BF*e 358909 (5.63)
Sti&Sche 131851 (2.07) BF*(C)e 387403 (6.08)
Stiefel*(C) 180997 (2.84) CowS(L) 443365 (6.96)
Dromo(PC)e 186277 (2.92)
Table 5. Position error at the epoch t ref,1(Table 3 ) for 160, 320, 640 steps per nominal period; example 3. The
numerical integrators are the 10th-order multistep methods ABM, SC-ABM, and the symbols !, !! indicate the use
of the ABM, SC-ABM, respectively. We provide also the time (average value over 20 runs) spent to numerically
integrate the system of differential equations from the initial to the final state vector. The total number of steps is
given by (160, 320, 640) times 49.5.
Formulations Position error (km) Time (s)
160 320 640 160 320 640
New 0.380 0.055 0.033 1.72 3.41 6.
Sti&Sche 0.342 0.055 0.033 1.75 3.48 6.
Stiefel*(C) 0.421 0.037 0.026 1.77 3.50 7.
KS! 0.215 0.039 0.026 1.70 3.38 6.
CowS(L)! 0.235 0.039 0.026 1.57 3.12 6.
Dromo(PC)e 11.225 0.018 0.001 1.75 3.48 6.
BF*(L)a!! 21.946 0.013 0.001 2.35 4.64 9.
Table 6. Same as Table 5 , but for the time interval t ref,2(Table 3 ). The total
number of steps is given by (160, 320, 640) times 50.

Position error (km)
Formulations 160 320 640

New 7.15 0.88 0.
Sti&Sche 6.29 0.88 0.
Stiefel(C) 5.96 0.81 0.
KS! 4.90 0.85 0.
CowS(L)! 5.21 0.85 0.
Dromo(PC)e 267.02 0.75 0.
BFa!! 506.11 1.44 0.

much bigger for Dromo(PL)e and BF*a already after a few nominal
periods, and the gap enlarges because of the faster error growth.
Among the other formulations, which are comparable in terms of
accumulated error, the best behaviour is shown by New(C) and
Sti&Sche, especially in the first one thousand nominal revolutions.

7.5 Additional comments

Some additional comments about the numerical tests are listed be-
low. (1) We discovered that the use of the total energy instead of the
generalized angular momentum in the B–F linearization (Appendix
C) is much more advantageous when the formulation is combined
to the DOPRI54 integrator. (2) The methods named Stiefel(C) and
Stiefel(L) (Appendix C), which are proposed here for the first time,
are always better than Stiefel(C). (3) The constant and linear time
elements developed for the new method (Section 4) do not bring a
significant benefit with the ABM integrator. (4) CowS(L) is always
more efficient than CowS, that is the linear time element is effective

at stabilizing the differential equation of the physical time. (5) For
the methods CowS, BF, and BF* we also tried to obtain the physical
time by integration of a second-order differential equation. It turns
out that this option is never convenient.
8 CONCLUSIONS
New orbital elements are developed for computing special pertur-
bations in the two-body problem. The projective decomposition of
the motion into the radial displacement and into the rotation of the
radial unit vector, which is borrowed from the Burdet–Ferrandiz lin- ́
earization, is carried out with a classical Sundman transformation of
the physical time. It is known that the orbital radius is a regular vari-
able with respect to the adopted fictitious time. Taking advantage of
this fact the first two elements are derived after applying the VOP
method to the radial equation of motion. The geometrical meaning
of the new quantities invites to define an intermediate frame, which,
as far as we know, has never been discovered before. This frame
remains fixed when the perturbations are absent and, in general, it
differs from the local vertical local horizontal frame by one rota-
tion around the direction of the angular momentum vector. Four
Euler parameters describing the attitude of the intermediate frame
are chosen as elements of the new method. They bring information
on the orbital plane and on the departure direction for the orbital
longitude of the propagated object. We show that also these four
elements can be obtained from a set of linear differential equations
(in the two-body problem) via the VOP method. The six elements
and the total energy, which is assumed to be negative, allow us to
completely characterize the motion in the fictitious time. A linear
and a constant time element is supplied to recover the physical
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
New non-singular orbital elements 2905
Figure 8. Position error accumulated during 5000 nominal periods; example 3: artificial satellite of the Earth perturbed by J 2 , Moon, solar radiation pressure,
atmospheric drag. The new method is compared with the formulations based on elements (left-hand) and on coordinates (right-hand). The numerical integrators
are the 10th-order multistep methods ABM, SC-ABM, and the number of steps per nominal period is 160. To avoid superpositions, the curves are shifted along
the vertical axis by a suitable power of 10 when necessary.

time. The final set of eight orbital elements is non-singular for zero
eccentricity, inclination, and non-zero angular momentum.
The performance of the new method was assessed by considering
perturbed scenarios around the Sun and the Earth. Two algorithms
representative of a variable and a fixed step-size integrator were
selected. The proposed elements are much more efficient than the
schemes exploiting a time transformation in which the orbital ra-
dius is squared. The only exception is for a short-term propagation
with a fixed step of a geocentric motion perturbed by the Earth’s
oblateness, the Moon’s attraction, the solar radiation pressure, and
the atmospheric drag. In this case, the highest accuracy with the
smallest computational cost is achieved by Dromo(PC) with the to-
tal energy as one of the state variables (Bau & Bombardelli` 2014 ).
It is impressive that the new method can become substantially more
efficient than the Kustaanheimo-Stiefel regularization and the re-
lated sets of regular elements included in the comparison. Moreover,
these formulations are never better than the new scheme in all the
numerical tests. The introduction of a time element is effective only
with a variable step-size integrator, and, in particular, we noted
that by employing a linear time element the computational cost at
high accuracies is lower with respect to the other methods. Finally,
it deserves to be said that we present new improved versions of
the original B–F method and of Stiefel’s set of spatial elements
completed by a time element (Arakida & Fukushima 2001 ).

REFERENCES
Arakida H., Fukushima T., 2001, AJ, 121, 1764
Barrio R., Serrano S., 2008, Math. Comput. Modelling, 48, 594
Bau G., Bombardelli C., 2014, AJ, 148, 1Bau G., Bombardelli C., Pel aez J., 2013, Celest. Mech. Dyn. Astron., 116, ́
53
Baumgarte J., 1972, Celest. Mech., 5, 490
Bond V. R., 1974, Celest. Mech., 10, 303
Bond V. R., Allman M. C., 1996, Modern Astrodynamics: Fundamentals
and Perturbation Methods. Princeton Univ. Press, Princeton, NJ
Broucke R. A., Cefola P., 1972, Celest. Mech., 5, 303
Broucke R., Lass H., Ananda M., 1971, A&A, 13, 390
Brown E. W., 1896, An Introductory Treatise on the Lunar Theory.
Cambridge Univ. Press, Cambridge

Burdet C. A., 1967, Z. Angew. Math. Phys., 18, 434
Burdet C. A., 1968, Z. Angew. Math. Phys., 19, 345
Burdet C. A., 1969, J. Reine Angew. Math., 238, 71
Cayley A., 1843, Camb. Math. Journal, 3, 224
Chelnokov Y. N., 1992, Kosm. Issled., 30, 759
Chelnokov Y. N., 1993, Kosm. Issled., 31, 3
Cohen C. J., Hubbard E. C., 1962, AJ, 67, 10
Dallas S. S., Rinderle E. A., 1974, J. Astronaut. Sci., 21, 129
Deprit A., 1975, J. Res. Nat. Bur. Stand. B, 79B, 1
Deprit A., 1976, Celest. Mech., 13, 253
Dormand J. R., Prince P. J., 1980, J. Comput. Appl. Math., 6, 19
Ferr ́andiz J. M., 1988, Celest. Mech., 41, 343
Ferr ́andiz J. M., Sansaturio M. E., Vigo J., 1991, in Roy A. E., ed., NATO
ASI Series, Vol. 272, Predictability, Stability, and Chaos in N-Body
Dynamical Systems. Plenum Press, New York, NY, p. 387
Flury W., Janin G., 1975, Astrophys. Space Sci., 36, 495
Fukushima T., 2004a, AJ, 128, 3108
Fukushima T., 2004b, AJ, 128, 3114
Fukushima T., 2007a, AJ, 133, 1
Fukushima T., 2007b, AJ, 133, 2815
Fukushima T., 2008, AJ, 135, 72
Garofalo A. M., 1960, AJ, 65, 117
Gurfil P., 2005, J. Guid. Control Dyn., 28, 1079
Hairer E., Nørsett S. P., Wanner G., 2009, Solving Ordinary Differential
Equations I: Nonstiff Problems. Springer-Verlag, Berlin
Hansen P. A., 1857, Abh. Kon. S ̈ achs. Ges. Wiss. Leipzig, 5, 41 ̈
Henrici P., 1962, Discrete Variable Methods in Ordinary Differential
Equations. Wiley, New York
Herget P., 1962, AJ, 67, 16
Herrick S., 1948, PASP, 60, 321
Herrick S., 1953, AJ, 58, 156
Hestenes D., 1983, Celest. Mech., 30, 151
Hintz G. R., 2008, J. Guid. Control Dyn., 31, 785
Janin G., 1974, Celest. Mech., 10, 451
Kustaanheimo P., Stiefel E. L., 1965, J. Reine Angew. Math., 218, 204
Marsden B. G., 1980, Celest. Mech., 22, 63
Milani A., Gronchi G. F., 2010, Theory of Orbit Determination. Cambridge
Univ. Press, Cambridge
Milankovic M., 1939, Bull. Acad. Sci. Math. Nat., 6, 1 ́
Montenbruck O., Gill E., 2000, Satellite Orbits – Models, Methods and
Applications, 1st edn. Springer, the Netherlands
Musen P., 1954, AJ, 59, 262
Musen P., 1958, AJ, 63, 426
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
2906 G. Bauetal.`
Musen P., 1960, J. Geophys. Res., 65, 1391
Musen P., 1961a, J. Astronaut. Sci., 8, 48
Musen P., 1961b, J. Geophys. Res., 66, 2797
Musen P., 1964, NASA Technical Report TN D-2301, On the Application
of Pfaff’s Method in the Theory of Variation of Astronomical Constants.
NASA, Washington, DC
Palacios M., Calvo C., 1996, J. Astronaut. Sci., 44, 63
Pel ́aez J., Hedo J. M., de Andres P. R., 2007, Celest. Mech. Dyn. Astron., ́
97, 131
Pines S., 1961, AJ, 66, 5
Rodrigues O., 1840, J. Math. Pures Appl., 5, 380
Rosengren A. J., Scheeres D. J., 2014, Celest. Mech. Dyn. Astron., 118, 197
Sharaf M. A., Awad M. E., Najmuldeen S. A. A., 1992, Earth Moon Planets,
56, 141
Sperling H., 1961, Am. Rocket Soc. J., 31, 660
Stiefel E. L., Scheifele G., 1971, Linear and Regular Celestial Mechanics.
Springer-Verlag, Berlin
Stiefel E., Rossler M., Waldvogel J., Burdet C. A., 1967, NASA Technical ̈
report CR-769, Methods of Regularization for Computing Orbits in
Celestial Mechanics. NASA, Washington, DC
Stromgren B., 1929, Publ. og mindre Medd. fra K ̈ ̈obenhavns Obs., 65, 3
Velez C. E., Cefola P. J., Long A. C., Nimitz K. S., 1974, in Bettis D. G., ed.,
Lecture Notes in Mathematics, Vol. 362, Proceedings of the Conference
on the Numerical Solution of Ordinary Differential Equations. Springer-
Verlag, Berlin, p. 183
Vitins M., 1978, Celest. Mech., 17, 173
Whittaker E. T., 1917, A Treatise on the Analytical Dynamics of particles
and rigid bodies, 2nd edn. Cambridge Univ. Press, Cambridge
Wilson E. B., 1901, Vector Analysis. Yale Univ. Press, New Haven

APPENDIX A
A1 Expression of ν (equation 5.15)

We start from the well-known formula

tan

(
θ−G
2
)
=
sinθ−sinG
cosθ+cosG
. (A1)
By use of equations (5.4), (5.5), (3.10), and (3.14) we end up after
some simplifications with

θ−G=2 arctan

( dr
dφ
c
√
λ 3 +r
)
. (A2)
Equation (5.3) is solved for the generalized angular momentum c ,
and by considering the relationg^2 =λ^21 +λ^22 , which follows from
(5.6) and (5.7), we have

c=

√
λ 3
(
1 −λ^21 −λ^22
)
. (A3)
Finally, by means of equations (3.17), (3.18), and (A3), and replac-
ingθ− G withν−φ(see equation 5.11), we can write (A2) into
the form shown in equation (5.15).

A2 Expression ofdd νφ (equation 5.20)

Consider the identity
(
c^2
r

− 1
)
i −c
dr
dt
j =λ 1 x +λ 2 y , (A4)
where both sides represent the generalized eccentricity vector g :the
left one is derived from equations (5.1) and (5.2), and the right one is
the expression in (5.8). After rearranging the terms, differentiation

of equation (A4) referred to the intermediate frame{F; x , y , k }
gives
dν
dφ
g e b=
dλ 1
dφ
x +
dλ 2
dφ
y +
d
dφ
(
1 −
c^2
r
)
i +
d
dφ
(
c
dr
dt
)
j ,
(A5)
withg=| g |and
g e b= k × g =c
dr
dt
i +
(
c^2
r
− 1
)
j. (A6)
Note that the relative angular velocityωIO(equation 5.12) is em-
ployed in the Poisson’s formulae for i and j.
The radial acceleration (3.7) is put in the form
d^2 r
dt^2
=
c^2
r^3
−
1
r^2
+R−
2 U
r
, (A7)
where we made appear the generalized angular momentum c
(see 5.2). Equations (3.8), (A6), and (A7) are used to write
d
dφ
(
1 −
c^2
r
)
i +
d
dφ
(
c
dr
dt
)
j =
dc
dφ
(
dr
dt
j −
2 c
r
i
)
+
c
√
− 2 ε
[g
r
e b+(Rr− 2 U) j
]
. (A8)
Since the unit vector e bsatisfies
e b· x =−sin(φ−G), e b· y =cos(φ−G), (A9)
e b· i =sinθ, e b· j =cosθ, (A10)
scalar multiplication by e bof equation (A5), modified according to
(A8), produces
dν
dφ
g=
dλ 2
dφ
cosβ−
dλ 1
dφ
sinβ+
dc
dφ
(
dr
dt
cosθ−
2 c
r
sinθ
)
+
c
√
− 2 ε
[g
r
+(Rr− 2 U)cosθ
]
, (A11)
whereβ=φ− G. With the help of equations (3.23), (3.24), (5.6),
and (5.7) we get
dλ 2
dφ
cosβ−
dλ 1
dφ
sinβ=( 2 U−Rr)
r
g
( 1 − )
+
dλ 3
dφ
ζ
2 λ 3 g
( 1 + ), (A12)
and differentiation of equation (A3) yields
dc
dφ
=
√
λ 3
m
[
( 2 U−Rλ 3
 )λ 3 ζ+
dλ 3
dφ
2 λ 3
]
. (A13)
Moreover, by using equations (5.4) and then (3.10), (3.14), (3.17),
(3.18), (A3), we find
dr
dt
cosθ−
2 c
r
sinθ=−
(
m^2
+ 1
)
ζ
g
√
λ 3
, (A14)
and
c
√
− 2 ε
[g
r
+(Rr− 2 U)cosθ
]
=
m
[
g+
λ 3
g
(Rr− 2 U)(m^2 − )
]
, (A15)
where m is given in (6.11).
Finally, the expressions derived in equations (A12)–(A15) are
plugged into (A11), we divide by g and apply the substitutionsζ^2
= (2− )− m^2 , g^2 = 1 − m^2 to find equation (5.20).
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
New non-singular orbital elements 2907
APPENDIX B: COMPUTATION OF λ 4 , λ 5 , λ 6 , λ 7

Whenλ 7 =0, equations (6.37) become singular. In this case, the
other Euler parameters are computed as follows:

λ 4 =

k 1
2 λ 6
,λ 5 =
k 2
2 λ 6
,λ 6 =
√
1 +k 3
2
. (B1)
If alsoλ 6 =0, then we use

λ 4 =

√
1 −y 2
2
,λ 5 =
y 1
2 λ 4
. (B2)
Finally, if evenλ 4 =0thenwesetλ 5 =1.

APPENDIX C
C1 Modified Stiefel’s elements completed by a time element

The original method of Stiefel (Stiefel et al. 1967 , p. 18) consists
of ten state variables: the physical time t , the variation W of the
instantaneous Keplerian energy per unit mass (ε K ) from its initial
value (ε K ,0), and eight elements related to the vector u of the four K-
S parameters. Arakida & Fukushima ( 2001 ) in the appendix of their
paper proposed to complete Stiefel’s elements with a time element
instead of the physical time. Here, we generalize these ten elements
with the aim of improving their performance in orbit computation.
Moreover, we also develop an alternative time element.
We start from equation A1 in Arakida & Fukushima ( 2001 ):
d^2 u
ds^2

+w^20 u = F , (C1)
where the independent variable s is introduced by the time trans-
formation d t = r d s , with r the orbital radius. The interesting fact in
equation (C1) is that the frequencyw 0 of the perturbed harmonic
oscillator is always a constant, while in the most known form of
the differential equation for u (Stiefel & Scheifele 1971 ,p.30,
equation 51) the frequency can be changed by the perturbations.
More specifically, we have

w^20 =−

εK, 0
2
, F =
1
4
(r q + 2 W u ), (C2)
where

q =−
∂U
∂ u
+ 2 LT f ,W=εK−εK, 0 , (C3)
beingL∈R^4 ×^4 the K–S matrix (Stiefel & Scheifele 1971 ,p.24,
equation 27),Uthe disturbing potential energy per unit mass, and
f a vector with the first three components given by P (see equa-
tion 3.2) and a vanishing fourth component.
We suggest to employ the initial value of the total energy per unit
mass (ε 0 ) in the definition ofw 0 (equation C2). By applying this
change, equation (C1) holds with

w^20 =−

ε 0
2
, F =
1
4
[r q + 2 (W−U) u ], (C4)
where q is given in (C3) and

W=ε−ε 0 , (C5)

beingε=εK+U. The quantity W in equation (C5) is one of the
elements of the improved formulation and its derivative with respect
to s reads (Stiefel & Scheifele 1971 , p. 31, see the equation for h in

dW
ds
=
∂U
∂t
r+ 2
d u
ds
·LT f. (C6)
The other elements are the time element ( t 0 ) and the four-
dimensional vectors (α,β) related to the K–S parameters u .The
definitions ofα,β, t 0 , and their differential equations are the same
as in equations A3, A5, and A6 of Arakida & Fukushima ( 2001 ),
whereinw 0 and F take the expressions in (C4).
Finally, we propose an other time element, which can be used in
place of t 0. Kepler’s equation written in terms of Stiefel’s elements
becomes (equation A4):
t=t 0 +
α^2 +β^2
2
s+
α^2 −β^2
4 w 0
sin(2w 0 s)−
α·β
2 w 0
cos(2w 0 s). (C7)
The new time element is defined as
t 1 =t 0 +
α^2 +β^2
2
s, (C8)
where t 0 is a constant along a Keplerian motion, while t 1 varies
linearly with s. From equations (C8) and A6 we find
dt 1
ds
=
α^2 +β^2
2
+
F · u
2 w^20
. (C9)
C2 Modified B–F regularization
Burdet ( 1969 ) introduced a transformation from the position vector
r to the reciprocal radiusρ=^1 rand the radial unit vector i = r r.
Changing the independent variable through the time transformation
dt
dφ
=
1
ξρ^2
, (C10)
whereξis a constant in the two-body problem, converts the differ-
ential equations ofρand i into four perturbed harmonic oscillators
with common frequencyw. The position and velocity can be fully
described byρ, i , their derivatives with respect toφ, and the semi-
latus rectum p .Ifξ=1, like in Burdet ( 1969 ), thenwis the angular
momentum per unit mass h , while ifξ= h , we have a unitary
frequency. The latter choice forξwas made by Burdet in a later
unpublished paper (see Flury & Janin 1975 ), and the resulting dif-
ferential equations for t ,ρ, i ,and p can be found in Vitins ( 1978 ,
section 2). Burdet’s linearization was developed in the Hamiltonian
formalism by Ferr ́andiz ( 1988 ), and it is usually referred to as B–F
regularization.
We propose a modified version of the B–F method which, as we
have only recently discovered, was also investigated by Vitins ( 1978 ,
section 4). Reference units for length and time are employed for
which the constant k^2 ( m + M ) becomes equal to 1 (see equation 3.1).
Letξ= c ,where c is the generalized angular momentum (see 5.2),
so that equation (C10) represents the same time transformation as
in Bau et al. (` 2013 , equation 3). The differential equations ofρ, i ,
c are
dρ
dφ
=σ,
d i
dφ
= u , (C11)
dσ
dφ
=−ρ+
1
c^2
+
1
c
(
fs−
dc
dφ
σ
)
, (C12)
d u
dφ
=− i +s^2 ( F r+f i )−
1
c
dc
dφ
u , (C13)
dc
dφ
=sr^2
[
P · u +
∂U
∂t
s−
(
2 U+r
∂U
∂ r
· i
)
σ
]
, (C14)
Downloaded from https://academic.oup.com/mnras/article/454/3/2890/1198076 by guest on 17 July 2025
2908 G. Bauetal.`
where the quantities F , P ,Uare defined as in equations (3.1) and
(3.2), and

s=

1
cρ
,f= 2 U−r F · i. (C15)
Equations (C12) and (C14) are reported, in a slightly different form,
also in Bau et al. (` 2013 ) and in Vitins ( 1978 ). Note that the velocity
vector is obtained by the formulav=c(ρ u −σ i )wherein the
potentialUdoes not explicitly appear. The total energyε(equation
3.9) can be selected as an alternative state variable to c. In this case
we have to add to (C10)–(C13), (C15) the two equations

dε
dφ
=r
[
P ·( u −σr i )+
∂U
∂t
s
]
,c=
√
2
ε+ρ
ρ^2 +σ^2
. (C16)
Following Ba`u & Bombardelli ( 2014 ), we define a linear and a
constant time element as

t 1 =t+

crσ
2 ε
+
k 0
ε
√
− 2 ε
,k 0 =arctan
(
cσ
cρ+
√
− 2 ε
)
,
(C17)
t 0 =t 1 −

φ
(− 2 ε)^3 /^2
, (C18)
which are governed by the differential equations
dt 1
dφ
=
1
(− 2 ε)^3 /^2
[
1 +
dε
dφ
(
3
ε
k 0 +k 1
)
−fk 2
]
, (C19)
dt 0
dφ
=
1
(− 2 ε)^3 /^2
{
dε
dφ
[
3
ε
(
k 0 +
φ
2
)
+k 1
]
−fk 2
}
, (C20)
where
k 1 =−
σs
√
− 2 ε
(
r+c^2
1 +c
√
− 2 ε
+ 2 c^2 −r
)
,
k 2 =s^2
(
1 + 2 εr
1 +c
√
− 2 ε
+ 1 +c
√
− 2 ε
)
. (C21)
Either equations (C17) and (C19), which were derived also by Vitins
( 1978 ), or equations (C18) and (C20), which are proposed here for
the first time, can substitute equation (C10).
This paper has been typeset from a TEX/LATEX file prepared by the author.